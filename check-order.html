<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>checkorder</title>
  <meta name="description" content="Solned  –∞–ª–±–∞–Ω —ë—Å–Ω—ã —É—Ä–∞–Ω –±“Ø—Ç—ç—ç–ª—á–∏–π–Ω —Ç–∞–Ω–∏–ª—Ü—É—É–ª–≥–∞,–∑–∞—Ö–∏–∞–ª–≥–∞, –∞–∂–∏–ª–∞—Ö –±“Ø—Å, –º—ç–¥—ç—ç –º—ç–¥—ç—ç–ª—ç–ª –±“Ø—Ö–∏–π –≤–µ–± —Å–∞–π—Ç.">
  <meta name="author" content="Solned –°–æ–¥–±–∞—è—Ä, –ú”©–Ω—Ö—Å–∞–π—Ö–∞–Ω, –¢—ç–ª–º—ç–Ω">
  <link rel="icon" type="image/png" href="./picture/icons/–õ–æ–≥–æ.png">
  <link rel="stylesheet" href="./styles/header.css">
  <link rel="stylesheet" href="./styles/global.css" />
  <link rel="stylesheet" href="./styles/Footer.css" />
  <link rel="stylesheet" href="./styles/zahialagshalgah.css">
  <script type="module" src="./js/order-management.js"></script>
  <script type="text/javascript" src="./js/darkmode.js" defer></script>
  <script src="./js/auth.js"></script>
  <script src="./js/header.js"></script>
  <link rel="stylesheet" href="./styles/login-header.css" />

</head>

<body>
  <header>
    <button id="theme-switch">
      <p>üåë</p>
      <p>‚òÄÔ∏è</p>
    </button>
    <nav>
      <ul>
        <li class="logo">
          <a href="Nuur.html">
            <img alt="logo" src="./picture/logo.png " />
          </a>
        </li>
        <li class="searchbar">
          <form action="/search" method="GET">
            <input
              type="text"
              name="search"
              id="search"
              placeholder="–•–∞–π–ª—Ç —Ö–∏–π—Ö..."
              aria-label="Search"
            />
            <button type="submit" class="search-btn">
              üîç
            </button>
          </form>
        </li>        
        <li class="checkorder">
          <a href="./check-order.html">üßæ–ó–∞—Ö–∏–∞–ª–≥–∞ —à–∞–ª–≥–∞—Ö</a>
        </li>
        <li class="login"><a href="login.html">–ù—ç–≤—Ç—Ä—ç—Ö</a></li>
      </ul>
    </nav>
  </header>
  <main id="checkOrderMain">
    <section id="orderSection">
      <h1 id="pageTitle">
        –ó–∞—Ö–∏–∞–ª–≥–∞ —à–∞–ª–≥–∞—Ö.
      </h1>
      <article id="orderForm">
        <h2 id="formTitle">–ó–∞—Ö–∏–∞–ª–≥–∞ —à–∞–ª–≥–∞—Ö –∫–æ–¥–æ–æ –æ—Ä—É—É–ª.</h2>
        <form id="checkOrderForm" action="/check-order" method="POST">
          <label id="orderLabel" for="orderNumber">–¢–∞–Ω–¥ ”©–≥—Å”©–Ω –∑–∞—Ö–∏–∞–ª–≥–∏–π–Ω –∫–æ–¥—ã–≥ –æ—Ä—É—É–ª–Ω–∞ —É—É:</label>
          <input type="text" id="orderNumber" name="orderNumber" required>
          <a id="submitButton" href="order-list.html">–®–∞–ª–≥–∞—Ö</a>
        </form>
      </article>
    </section>
  </main>
  <hr>
  <footer>
    <section class="social-address">
      <a href="Nuur.html">
        <img src="./picture/logo.png " width="30" alt="Company logo" />
      </a>
      <section>
        <img src="picture/icons//facebook.png" alt="facebook" />
        <img src="picture/icons/instagram.png" alt="facebook" />
      </section>

      <a href="https://www.apple.com/app-store/">
        <button>
          <img src="picture/icons//apple.png" alt="Apple Store" />
          <p>Appstore-–æ–æ—Å —Ç–∞—Ç–∞–∂ –∞–≤–∞—Ö</p>
        </button>
      </a>

      <a href="https://play.google.com/store">
        <button>
          <img src="picture/icons//apple.png" alt="Apple Store" />
          <p>Appstore-–æ–æ—Å —Ç–∞—Ç–∞–∂ –∞–≤–∞—Ö</p>
        </button>
      </a>
    </section>
    <section class="about-us">
      <ul>
        <li>
          <h2>SOLNED</h2>
        </li>
        <li>
          <a href="#">–ë–∏–¥–Ω–∏–π —Ç—É—Ö–∞–π</a>
        </li>
        <li>
          <a href="#">–¢—É—Å–ª–∞–º–∂</a>
        </li>
      </ul>
      <ul>
        <li>
          <h2>–•–û–õ–ë–û–û –ë–ê–†–ò–•</h2>
        </li>
        <li>
          <a href="gmail.com">Solned@gmail.com</a>
        </li>
        <li>
          <a>–û—Ñ—Ñ–∏—Å, –ß–∏–Ω–≥—ç–ª—Ç—ç–π</br /> –¥“Ø“Ø—Ä—ç–≥ 6-—Ö–æ—Ä–æ–æ, </br />53 –±–∞–π—Ä</a>
        </li>
      </ul>
    </section>
  </footer>
</body>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const orderForm = document.getElementById('checkOrderForm');
    const orderNumberInput = document.getElementById('orderNumber');
    const submitButton = document.getElementById('submitButton');

    // Add error container to HTML
    const errorDiv = document.createElement('div');
    errorDiv.id = 'errorContainer';
    errorDiv.style.color = 'red';
    errorDiv.style.display = 'none';
    orderForm.appendChild(errorDiv);

    // Fix the form submission 
    submitButton.addEventListener('click', async function (e) {
        e.preventDefault();
        const orderCode = orderNumberInput.value.trim();
        
        if (!orderCode) {
            showError('–ó–∞—Ö–∏–∞–ª–≥—ã–Ω –∫–æ–¥ –æ—Ä—É—É–ª–Ω–∞ —É—É.');
            return;
        }

        try {
            const response = await fetch(`http://localhost:3000/api/orders/check/${orderCode}`);
            const data = await response.json();

            if (data.success && data.data) {
                // Redirect only if we have valid data
                window.location.href = `order-list.html?orderNumber=${orderCode}`;
            } else {
                showError('–ë“Ø—Ä—Ç–≥—ç–ª–≥“Ø–π –∑–∞—Ö–∏–∞–ª–≥—ã–Ω –∫–æ–¥ –±–∞–π–Ω–∞!');
            }
        } catch (error) {
            showError('–ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞. –î–∞—Ö–∏–Ω –æ—Ä–æ–ª–¥–æ–Ω–æ —É—É.');
        }
    });

    function showError(message) {
        const errorContainer = document.getElementById('errorContainer');
        errorContainer.textContent = message;
        errorContainer.style.display = 'block';
    }
});
</script>


</html>